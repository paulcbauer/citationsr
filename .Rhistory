if(length(doi)==0){doi <- "no doi"}
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
matched <- stringr::str_match(x, journal.titles)
cd.journal <- matched[!is.na(matched)][1]
if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi=doi, crossref.info, full.line, cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
doc.information
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
matched <- stringr::str_match(x, journal.titles)
cd.journal <- matched[!is.na(matched)][1]
if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[i,] <- c(doi, crossref.info, full.line, cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
cr_works(query="American Journal of Political Science, Vol. 55, No. 2, April 2011, Pp. 370–382", limit = 1)
# YEAR
# Get year from the authors
year <- stringr::str_extract("ª The Author(s) 2011", "(?=The Author\\(s\\)).*")
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
matched <- stringr::str_match(x, journal.titles)
cd.journal <- matched[!is.na(matched)][1]
if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi=doi, crossref.info=crossref.info, full.line=full.line, cd.journal=cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
matched <- stringr::str_match(x, journal.titles)
cd.journal <- matched[!is.na(matched)][1]
if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi=doi, crossref.info=crossref.info, full.line=full.line, cd.journal=cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
doc.information
doc.information
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
matched <- stringr::str_match(x, journal.titles)
cd.journal <- matched[!is.na(matched)][1]
if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi, crossref.info, full.line, cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
doc.information
cr_works(query="ARE NICHE PARTIES DIFFERENT?", limit = 1)
x <- cr_works(query="ARE NICHE PARTIES DIFFERENT?", limit = 1)
x
x$data
x$data$funder
x$data$DOI
x$data$title
doc.information
x <- cr_works(query="American Journal of Political Science, Vol. 50, No. 3, July 2006, Pp. 513–529", limit = 1)
x
x$data$title
x$data$DOI
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
# USE OTHER STRATEGIES IF NO DOI PRESENT
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
# Use full line to search for article
x <- cr_works(query=full.line, limit = 1)
doi.2 <- x$data$DOI
crossref.info <- cr_cn(dois = doi.2, format = "text", style = "apa")
# if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
matched <- stringr::str_match(x, journal.titles)
cd.journal <- matched[!is.na(matched)][1]
if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi, crossref.info, full.line, cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
setwd("C:/Users/paul/Google Drive/Research/2016_Quality_of_citations/data")
# journals <- read.csv("./identify_citation_document/new table.csv", sep=";", header=T)
# journals$Title <- as.character(journals$Title)
# List file names
file.names <- dir(paste("./", folder, sep = ""), pattern = ".txt")
file.paths <- paste(paste("./", folder, "/", sep = ""), file.names, sep="")
n.docs <- length(file.paths)
# Specify number of documents
if(!is.null(number)){n.docs <- number}
# Load documents and search for full citation in them
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
# USE OTHER STRATEGIES IF NO DOI PRESENT
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
# Use full line to search for article
x <- cr_works(query=full.line, limit = 1)
doi.2 <- x$data$DOI
crossref.info <- cr_cn(dois = doi.2, format = "text", style = "apa")
# if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
matched <- stringr::str_match(x, journal.titles)
cd.journal <- matched[!is.na(matched)][1]
if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi, crossref.info, full.line, cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
# USE OTHER STRATEGIES IF NO DOI PRESENT
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
# Use full line to search for article
cr.query <- cr_works(query=full.line, limit = 1)
doi.2 <-  cr.query$data$DOI
crossref.info <- cr_cn(dois = doi.2, format = "text", style = "apa")
# if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
matched <- stringr::str_match(x, journal.titles)
cd.journal <- matched[!is.na(matched)][1]
if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi, crossref.info, full.line, cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
i <-5
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
doi
i <- 4
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
doi
if(length(doi)==0){doi <- "no doi"}
doi
if(length(doi)==0){doi <- "no doi"}else{
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
}
doi
length(doi)==0
length(doi)=="no doi"
doi
doi=="no doi"
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
full.line
cr.query <- cr_works(query=full.line, limit = 1)
cr.query
doi.2 <-  cr.query$data$DOI
doi.2
crossref.info <- cr_cn(dois = doi.2, format = "text", style = "apa")
crossref.info
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}else{
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
}
# USE OTHER STRATEGIES IF NO DOI PRESENT
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
if(doi=="no doi"){
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
# Use full line to search for article
cr.query <- cr_works(query=full.line, limit = 1)
doi.2 <-  cr.query$data$DOI
crossref.info <- cr_cn(dois = doi.2, format = "text", style = "apa")
}
# if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
# journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
# matched <- stringr::str_match(x, journal.titles)
# cd.journal <- matched[!is.na(matched)][1]
# if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi, crossref.info, full.line, cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
doc.information
full.line
i <- 17
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}else{
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
}
# USE OTHER STRATEGIES IF NO DOI PRESENT
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
full.line
detected
full.line <- x[detected]
full.line
setwd("C:/Users/paul/Google Drive/Research/2016_Quality_of_citations/data")
# journals <- read.csv("./identify_citation_document/new table.csv", sep=";", header=T)
# journals$Title <- as.character(journals$Title)
# List file names
file.names <- dir(paste("./", folder, sep = ""), pattern = ".txt")
file.paths <- paste(paste("./", folder, "/", sep = ""), file.names, sep="")
n.docs <- length(file.paths)
# Specify number of documents
if(!is.null(number)){n.docs <- number}
# Load documents and search for full citation in them
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}else{
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
}
# USE OTHER STRATEGIES IF NO DOI PRESENT
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
if(doi=="no doi"){
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
# Use full line to search for article
if(length(full.line)!=0){
cr.query <- cr_works(query=full.line, limit = 1)
doi.2 <-  cr.query$data$DOI
crossref.info <- cr_cn(dois = doi.2, format = "text", style = "apa")
}
}
# if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
# journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
# matched <- stringr::str_match(x, journal.titles)
# cd.journal <- matched[!is.na(matched)][1]
# if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi, crossref.info, full.line, cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
doc.information
doc.information <- NULL
for (i in 1:n.docs){
con <- file(file.paths[i], encoding = "UTF-8")
x <- readLines(con, warn = F, n = 200)
close(con)
# FIND DOI
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*|^10\\.[0-9]{2,6}/[0-9\\.\\-a-zA-Z/]*")
doi <- doi[!is.na(doi)]
if(length(doi)==0){doi <- "no doi"}else{
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
doi <- doi[1]
crossref.info <- "no cross ref info"
if(doi!="no doi"){crossref.info <- cr_cn(dois = doi, format = "text", style = "apa")}
}
# USE OTHER STRATEGIES IF NO DOI PRESENT
# print(doi)
# DOI - Use doi to get publication info from crossref?
# FIND FULL LINE
if(doi=="no doi"){
detected <- stringr::str_detect(x, paste("(?=.*Vol\\.)(?=.*No\\.).*|(?=.*Volume)(?=.*Issue).*", sep=""))
full.line <- x[detected]
# Use full line to search for article
if(length(full.line)!=0){
cr.query <- cr_works(query=full.line, limit = 1)
doi.2 <-  cr.query$data$DOI
crossref.info <- cr_cn(dois = doi.2, format = "text", style = "apa")
}
}
# if(length(full.line)==0){full.line <- "no full line"}
# print(full.line)
# (?=.*(", paste(month.name, collapse="|"), "))
#
# JOURNAL TITLE
# journal.titles <- c("American Political Science Review|International Organization")
# journal.titles <- paste(journals$Title, collapse = "|")
# matched <- stringr::str_match(x, journal.titles)
# cd.journal <- matched[!is.na(matched)][1]
# if(is.na(cd.journal)){cd.journal <- "no title"}
# print(cd.journal)
doc.information[[i]] <- c(doi, crossref.info, full.line, cd.journal)
# Counter
if(stringr::str_detect(as.character(i), "[0-9]*0")){cat(i, ".. ", sep="")}
}
doc.information
x <- c("http://dx.doi.org/10.1016/j.enpol.2014.02.036", "10.1177/0010414008328637")
doi <- stringr::str_extract(x, "(DOI:?|doi:?)\\s{0,2}[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z]*(/[0-9\\.\\-a-zA-Z]*)?|http://dx\\.doi\\.org/[0-9\\.\\-a-zA-Z]*/[0-9\\.\\-a-zA-Z/]*|^10\\.[0-9]{2,6}/[0-9\\.\\-a-zA-Z/]*")
doi
doi <- doi[!is.na(doi)]
doi
if(length(doi)==0){doi <- "no doi"}else{
doi <- stringr::str_replace(doi, "^DOI |^DOI: |DOI:|^doi |^doi: |doi:|http://dx\\.doi\\.org/", "")
}
doi
library(citations)
