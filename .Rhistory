library(rglwidget)
library(leaflet)
library(haven)
library(plyr)
library(dplyr)
library(rgdal)
library(stargazer)
# Start the clock!
n <- 1000 # set number of draws
set.seed(777) # set seed
standarddevs <- seq(0.001,20,0.1)
correlations <- seq(0,0.9,0.1)
objectlength <- length(standarddevs)*length(correlations)
objectlength
# Generate vectors for both sds and correlations
sdsvector <- rep(standarddevs, each = length(correlations))
corrsvector <- rep(correlations, length(standarddevs))
# Create storing objects
sims <- sapply(paste(1:objectlength),function(x) NULL)
dist <- sapply(paste(1:objectlength),function(x) NULL)
R <- sapply(paste(1:objectlength),function(x) NULL)
# library(compiler)
# enableJIT(3)
Rprof("file.out")
ptm <- proc.time()
for(i in 1:objectlength){ # loop across SD
print(i)
# Draw and sort numbers for cummulative probabilites
dist[[i]] <- sort(rtruncnorm(5, a=0, b=1, mean = 0.5, sd = sdsvector[i]))
# Generate correlation matrix
R[[i]] <- matrix(c(1, corrsvector[i], corrsvector[i],
corrsvector[i], 1, corrsvector[i],
corrsvector[i], corrsvector[i], 1),
3,3)
# Sample from multivariate discrete distribution and generate data.frame
sims[[i]] <- ordsample(n, list(dist[[i]], dist[[i]], dist[[i]]), R[[i]])
}
proc.time() - ptm
Rprof(NULL)
summaryRprof("file.out")
# Compute variation measure d^2
# Calculated on the first column of the simulate data matrix - but is similar for other columns with large samples
# Only the cumulative probabilites for the first distribution are calculated
sims.dsquare <- lapply(sims, function(x){
sum((cumsum(prop.table(table(x[,1])))[-6] - 1/2)^2)
})
# Compute sd from samples - Mean across three distributions
sims.sd <- lapply(sims, function(x){
(sd(x[,1])+sd(x[,2])+sd(x[,3]))/3
})
# Avopscore Mean and Variance
sims.avopscore <- lapply(sims,rowMeans)
sims.avopscore.Mean <- lapply(sims.avopscore,mean)
sims.avopscore.Var <- lapply(sims.avopscore,var)
# Av. correlation
sims.cormatrices <- lapply(sims, cor)
sims.cormatrices.lower  <- lapply(sims.cormatrices, function(x) {x[lower.tri(x)]})
sims.av.correlation <- lapply(sims.cormatrices.lower, mean)
# Av. variances
sims.colvars  <- lapply(sims, function(x) {apply(x, 2, var)})
sims.av.variance  <- lapply(sims.colvars, mean)
# Av. kurtosis
sims.colkkurtosis  <- lapply(sims, function(x) {apply(x, 2, kurtosis)})
sims.av.kurtosis  <- lapply(sims.colkkurtosis, mean)
# Av. IQR
sims.col.IQR  <- lapply(sims, function(x) {apply(x, 2, IQR)})
sims.av.IQR  <- lapply(sims.col.IQR, mean)
# COMBING IN DATA FRAME
values <- data.frame(
corr = unlist(sims.av.correlation),
sd = unlist(sims.sd),
dsquare = unlist(sims.dsquare),
var.opscore = unlist(sims.avopscore.Var),
mean.opscore = unlist(sims.avopscore.Mean),
av.iqr = unlist(sims.av.IQR),
av.kurtosis = unlist(sims.av.kurtosis),
av.variance = unlist(sims.av.variance))
# Max dsquared value = (6-1)/6 = (categories k - 1)/4
values$lsquare <- values$dsquare/(5-1)/4
values$normalized.dsquare <- values$dsquare/max(values$dsquare)
summary(values$dsquare)
summary(values$lsquare)
summary(values$normalized.dsquare)
values <- arrange(values, dsquare, sd)
write.table(values, "simulatedvalues.csv", sep=",")
install.packages("fulltext")
library(citations)
install.packages("roxygen2")
library(citations)
install.packages("testthat")
library(citations)
library(citations)
library(citations)
library(citationsr)
library(citationsr)
library(citationsr)
setwd("C:/Users/Paul/GDrive/1-Research/2016_06_Quality_of_citations/citationsr-paper")
dir.create("output")
dir.create("output/acemoglu_2001")
file <- "../data/AcemogluJohnsonRobinson_2001_citation_cases.csv"
article <- "Acemoglu, Johnson & Robinson (2001)"
output <- "output/acemoglu_2001"
analyze_citations(file, article, output)
Sys.Date()
# setwd("~/Google Drive/2016_Quality_of_citations/")
# setwd("C:/Users/pbauer/Downloads")
setwd("C:/Users/Paul/GDrive/1-Research/2016_06_Quality_of_citations/citationsr-paper")
library(citations)
# Acemoglu 2001
dir.create("output")
dir.create("output/acemoglu_2001")
file <- "../data/AcemogluJohnsonRobinson_2001_citation_cases.csv"
article <- "Acemoglu, Johnson & Robinson (2001)"
output <- "output/acemoglu_2001"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Audretsch 1996
dir.create("output/audretsch_1996")
file <- "data/AudretschFeldman_1996_citation_cases.csv"
article <- "Audretsch and Feldman (1996)"
output <- "output/audretsch_1996"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Beck 1995
dir.create("output/beck_1995")
file <- "data/BeckKatz_1995_citation_cases.csv"
article <- "Beck and Katz (1995)"
output <- "output/beck_1995"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Fearon 2003
dir.create("output/fearon_2003")
file <- "data/FearonLaitin_2003_citation_cases.csv"
article <- "Fearon and Laitin (2003)"
output <- "output/fearon_2003"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Inglehart 2000
dir.create("output/inglehart_2000")
file <- "data/InglehartBaker_2000_citation_cases.csv"
article <- "Inglehart and Baker (2000)"
output <- "output/inglehart_2000"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Uzzi 1996
dir.create("output/uzzi_1996")
file <- "data/Uzzi_1996_citation_cases.csv"
article <- "Uzzi (1996)"
output <- "output/uzzi_1996"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
install.packages("stm")
setwd("C:/Users/Paul/GDrive/1-Research/2016_06_Quality_of_citations/citationsr-paper")
library(citations)
# Acemoglu 2001
dir.create("output")
dir.create("output/acemoglu_2001")
file <- "../data/AcemogluJohnsonRobinson_2001_citation_cases.csv"
article <- "Acemoglu, Johnson & Robinson (2001)"
output <- "output/acemoglu_2001"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Audretsch 1996
dir.create("output/audretsch_1996")
file <- "data/AudretschFeldman_1996_citation_cases.csv"
article <- "Audretsch and Feldman (1996)"
output <- "output/audretsch_1996"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Beck 1995
dir.create("output/beck_1995")
file <- "data/BeckKatz_1995_citation_cases.csv"
article <- "Beck and Katz (1995)"
output <- "output/beck_1995"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Fearon 2003
dir.create("output/fearon_2003")
file <- "data/FearonLaitin_2003_citation_cases.csv"
article <- "Fearon and Laitin (2003)"
output <- "output/fearon_2003"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Inglehart 2000
dir.create("output/inglehart_2000")
file <- "data/InglehartBaker_2000_citation_cases.csv"
article <- "Inglehart and Baker (2000)"
output <- "output/inglehart_2000"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Uzzi 1996
dir.create("output/uzzi_1996")
file <- "data/Uzzi_1996_citation_cases.csv"
article <- "Uzzi (1996)"
output <- "output/uzzi_1996"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
setwd("C:/Users/Paul/GDrive/1-Research/2016_06_Quality_of_citations/citationsr-paper")
getwd()
library(citations)
dir.create("output")
dir.create("output/acemoglu_2001")
file <- "../data/AcemogluJohnsonRobinson_2001_citation_cases.csv"
article <- "Acemoglu, Johnson & Robinson (2001)"
output <- "output/acemoglu_2001"
analyze_citations(file, article, output)
dir.create("output")
dir.create("output/acemoglu_2001")
file <- "../data/AcemogluJohnsonRobinson_2001_citation_cases.csv"
article <- "Acemoglu, Johnson & Robinson (2001)"
output <- "output/acemoglu_2001"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
topic_analysis(file, article, output)
dir.create("output/audretsch_1996")
file <- "../data/AudretschFeldman_1996_citation_cases.csv"
article <- "Audretsch and Feldman (1996)"
output <- "output/audretsch_1996"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Beck 1995
dir.create("output/beck_1995")
file <- "../data/BeckKatz_1995_citation_cases.csv"
article <- "Beck and Katz (1995)"
output <- "output/beck_1995"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Fearon 2003
dir.create("output/fearon_2003")
file <- "../data/FearonLaitin_2003_citation_cases.csv"
article <- "Fearon and Laitin (2003)"
output <- "output/fearon_2003"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Inglehart 2000
dir.create("output/inglehart_2000")
file <- "../data/InglehartBaker_2000_citation_cases.csv"
article <- "Inglehart and Baker (2000)"
output <- "output/inglehart_2000"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
# Uzzi 1996
dir.create("output/uzzi_1996")
file <- "../data/Uzzi_1996_citation_cases.csv"
article <- "Uzzi (1996)"
output <- "output/uzzi_1996"
analyze_citations(file, article, output)
topic_analysis(file, article, output)
library(citationsr)
library(citationsr)
?analyze_citations
library(fulltext)
setwd("C:\\Users\\Paul\\GDrive\\Research\\2017_Quality_of_citations\\data")
setwd("C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data")
folder <- "docs"
file.names <- dir(paste("./", folder, sep = ""), pattern = ".pdf")
file.paths <- paste(paste("./", folder,"/", sep = ""), file.names, sep="")
# renaming
for(i in 1:length(file.paths)){
file.rename(from = file.paths[i],
to = paste(folder, "/doc", i, ".pdf", sep=""))
}
setnumber <- NULL
extract_text(folder = folder, number = setnumber)
library(citationsr)
extract_text(folder = folder, number = setnumber)
dest <- "C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data\\docs"
myfiles <- list.files(path = dest, pattern = "pdf",
full.names = TRUE)
myfiles
dest <- "C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data\\docs"
# make a vector of PDF file names
myfiles <- list.files(path = dest, pattern = "pdf",  full.names = TRUE)
pdftotext.path <- as.character(Sys.which("pdftotext.exe"))
pdftotext.path
lapply(myfiles, function(i) system(paste(paste('"', pdftotext.path, '"', sep=""),paste0('"', i, '"')), wait = FALSE) )
extracttext <- function(i) {system(paste('"C:/Program Files/xpdf/bin64/pdftotext.exe"', paste0('"', i, '"')), wait = TRUE)}
extracttext(myfiles[1])
pdftotext.path
extracttext <- function(i) {system(paste('"pdftotext.path"', paste0('"', i, '"')), wait = TRUE)}
myfiles
extracttext(myfiles[1])
extracttext(myfiles[2])
i <- 1
system(paste('"pdftotext.path"', paste0('"', i, '"')), wait = TRUE)
pdftotext.path
extracttext <- function(i) {system(paste('"C:\\PROGRA~2\\MIKTEX~1.9\\miktex\\bin\\PDFTOT~1.EXE"', paste0('"', i, '"')), wait = TRUE)}
extracttext(myfiles[1])
lapply(myfiles, extracttext)
extracttext(myfiles[1:128])
extracttext
extracttext <- function(i) {system(paste('"C:\\PROGRA~2\\MIKTEX~1.9\\miktex\\bin\\PDFTOT~1.EXE"', paste0('"', i, '"')), wait = TRUE); print(i)}
lapply(myfiles, extracttext)
ptm <- proc.time()
lapply(myfiles, extracttext)
library(pdftools)
install.packages("pdftools")
?pdftools::pdf_text()
?pdftools::pdf_text
myfiles
myfiles[2]
myfiles[1]
pdf_file <- myfiles[1]
info <- pdf_info(pdf_file)
library(pdftools)
info <- pdf_info(pdf_file)
info
text <- pdf_text(pdf_file)
text
paste(text, collapse = "PAGE")
i
text
getwd)
getwd()
pdf_file
substr(pdf_file, 1, nchar(pdf_file)-4)
# setwd("C:/Users/Paul/GDrive/1-Research/2016_06_Quality_of_citations/citationsr-paper")
# library(knitr)
# opts_chunk$set(cache=TRUE)
# opts_chunk$set(cache.path = "cache/")
paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt", sep="")
paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt", sep="")
myfiles[1]
text <- pdf_text(myfiles[1])
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt", sep=""), sep="NEWPAGE")
extracttext.pdftools <- function(i) {
text <- pdf_text(i)
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt", sep=""), sep="NEWPAGE")
print(i)
}
ptm <- proc.time()
lapply(myfiles, extracttext.pdftools)
extracttext.pdftools <- function(i) {
pdf_file <- i
text <- pdf_text(pdf_file)
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt", sep=""), sep="NEWPAGE")
print(i)
}
ptm <- proc.time()
lapply(myfiles, extracttext.pdftools)
extracttext.pdftools <- function(i) {
pdf_file <- i
text <- pdf_text(pdf_file)
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt", sep=""))
print(i)
}
ptm <- proc.time()
lapply(myfiles[1], extracttext.pdftools)
extracttext.pdftools <- function(i) {
pdf_file <- i
text <- pdf_text(pdf_file)
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt", collapse="NEWPAGE"))
print(i)
}
ptm <- proc.time()
lapply(myfiles[1], extracttext.pdftools)
extracttext.pdftools <- function(i) {
pdf_file <- i
text <- pdf_text(pdf_file)
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt", collapse="NEWPAGE"))
print(i)
}
ptm <- proc.time()
lapply(myfiles[1], extracttext.pdftools)
extracttext.pdftools <- function(i) {
pdf_file <- i
text <- pdf_text(pdf_file)
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt", collapse="NEWPAGE"))
print(i)
}
ptm <- proc.time()
lapply(myfiles[1], extracttext.pdftools)
?write
i <- myfiles[1]
pdf_file <- i
text <- pdf_text(pdf_file)
text
text <- paste(text, collapse = "\n NEWPAGE\n")
text
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt"))
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt"))
pdf_file <- i
text <- pdf_text(pdf_file)
text <- paste(text, collapse = "\n NEWPAGE \n")
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt"))
pdf_file <- i
text <- pdf_text(pdf_file)
text <- paste(text, collapse = "\n NEWPAGE \n\n")
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt"))
?write.csv2
?write.csv
?readr::write_csv
?readr::read_csv
?readr::read_csv2
library(citationsr)
library(citationsr)
getwd()
setwd("C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data")
dest <- "C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data\\docs"
myfiles <- list.files(path = dest, pattern = "pdf",
full.names = TRUE)
dest <- "C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data\\docs"
myfiles <- list.files(path = dest, pattern = "pdf",
full.names = TRUE)
extracttext.pdftools <- function(i) {
pdf_file <- i
text <- pdf_text(pdf_file)
text <- paste(text, collapse = "\n NEWPAGE \n\n")
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt"))
print(i)
}
ptm <- proc.time()
lapply(myfiles[1:400], extracttext.pdftools)
proc.time() - ptm
setnumber <- 400
get_metadata_doc_nv(folder, number = setnumber)
setnumber <- 200
# folder <- "docs/renaming not working"
### Text extraction ###
extract_text(folder = folder, number = setnumber)
get_metadata_doc_nv(folder, number = setnumber)
get_metadata_doc_nv(folder, number = setnumber)
get_metadata_doc_nv(folder, number = setnumber)
get_metadata_doc_nv(folder, number = setnumber)
setnumber <- 400
# folder <- "docs/renaming not working"
### Text extraction ###
ptm <- proc.time()
extract_text(folder = folder, number = setnumber)
setnumber <- 400
# folder <- "docs/renaming not working"
### Text extraction ###
ptm <- proc.time()
extract_text(folder = folder, number = setnumber)
setnumber <- 500
# folder <- "docs/renaming not working"
### Text extraction ###
ptm <- proc.time()
extract_text(folder = folder, number = setnumber)
proc.time() - ptm
?proc.time
230/60
setnumber
dest <- "C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data\\docs"
myfiles <- list.files(path = dest, pattern = "pdf",
full.names = TRUE)
extracttext.pdftools <- function(i) {
pdf_file <- i
text <- pdf_text(pdf_file)
#text <- paste(text, collapse = "\n NEWPAGE \n\n")
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt"))
print(i)
}
ptm <- proc.time()
lapply(myfiles[1:setnumber], extracttext.pdftools)
dest <- "C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data\\docs"
myfiles <- list.files(path = dest, pattern = "pdf",
full.names = TRUE)
extracttext.pdftools <- function(i) {
pdf_file <- i
text <- pdf_text(pdf_file)
#text <- paste(text, collapse = "\n NEWPAGE \n\n")
write(text, paste(substr(pdf_file, 1, nchar(pdf_file)-4), ".txt"))
# print(i)
}
ptm <- proc.time()
lapply(myfiles[1:setnumber], extracttext.pdftools)
proc.time() - ptm
151.83/60
setnumber <- 500
# folder <- "docs/renaming not working"
### Text extraction ###
ptm <- proc.time()
extract_text(folder = folder, number = setnumber)
proc.time() - ptm
setnumber <- 500
# folder <- "docs/renaming not working"
### Text extraction ###
ptm <- proc.time()
extract_text(folder = folder, number = setnumber)
proc.time() - ptm
get_metadata_doc_nv(folder, number = setnumber)
library(citations)
setwd("C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data")
### Set folder ###
folder <- "docs"
# Rename filenames for first extraction
file.names <- dir(paste("./", folder, sep = ""), pattern = ".pdf")
file.paths <- paste(paste("./", folder,"/", sep = ""), file.names, sep="")
# renaming
for(i in 1:length(file.paths)){
file.rename(from = file.paths[i],
to = paste(folder, "/doc", i, ".pdf", sep=""))
}
library(citations)
setwd("C:\\Users\\Paul\\GDrive\\1-Research\\2017_Quality_of_citations\\data")
### Set folder ###
folder <- "docs"
# Rename filenames for first extraction
file.names <- dir(paste("./", folder, sep = ""), pattern = ".pdf")
file.paths <- paste(paste("./", folder,"/", sep = ""), file.names, sep="")
# renaming
for(i in 1:length(file.paths)){
file.rename(from = file.paths[i],
to = paste(folder, "/doc", i, ".pdf", sep=""))
}
setnumber <- 200
ptm <- proc.time()
extract_text(folder = folder, number = setnumber)
proc.time() - ptm
get_metadata_doc_nv(folder, number = setnumber)
get_metadata_doc_nv(folder, number = setnumber)
