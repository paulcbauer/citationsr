# Citations
The R package 'citations' comprises functions that can be used to analyze citation cases, i.e. citations within documents that cite a particular (or several) studies. These functions would normally be executed in a sequence.

1. `extract_text()`: Extract text from citing documents (PDFs) and saves text in text files with the same name. 
1. `identify_citing_doct()`: Identifies citing documents (PDFs) either by finding a DOI and querying information using that DOI or by trying to extract title, journal, pages etc. from the PDF itself.
2. `identify_study_doc()`: Runs through citing documents and identifes whether study of interest was really cited in there, i.e. whether it appears in the references. Produces a table with the extracted reference (if there has been) to the study.
3. `delete_ref_section()` and `delete_running_heads()`: Clean up .txt files of citing documents (omitting/deleting reference section and running heads) to facilitate citation case extraction. 
5. `clean_text()`: Clean .txt files (e.g. replace abbreviation) to facilitate citation case extraction.
8. `extract_citation_cases()`: Extract citations cases from citing documents (.txt files). 
9. Analyze the extracted citation cases: to be continued...

* `clean_pdf_filenames` and `numeric_to_name` are unfinished functions. The former shall rename PDF files with problematic names. The latter shall convert citing documents from the numeric to the name citation system.


# How to...

## Prerequesites

* You need to install xpdf into the folder C:\Program Files\xpdf

## First steps
Install/load the package.
```{r, echo=T, eval=F}
install.packages("devtools")
devtools::install_github("paulbauer/citations")
library(citations)
```

Set working directory to folder that, in turn, contains folders (e.g. "Beck 1995", "Tumasjan 2010") or just a single folder that contain(s) the citing documents (PDFs) for particular studies. Later on you specify the respective subfolders in the function.
```{r, echo=T, eval=F}
setwd("C:/Users/paul/Google Drive/Research/2016_Quality_of_citations/data")
```




## Example: A single study (20 documents)
```{r, echo=T, eval=F}
extract_text(folder = "Beck 1995", number = 20)
identify_citing_document(folder = "Beck 1995", number = 10)
identify_study(study.title = "What to Do (and Not to Do) with Time-Series Cross-Section Data",
                 folder = "Beck 1995"#
                 ,  number = 20)
delete_reference_section(folder = "Beck 1995", number = 20)
delete_running_heads(folder = "Beck 1995", number = 20)
clean_text(folder = "Beck 1995", number = 20)
extract_citation_cases(folder = "Beck 1995",
                         authorname = "Beck, Katz",
                         studyyear = "1995",
                         number = 20) # scope = 2
```


## Example: A single study
```{r, echo=T, eval=F}
identify_citing_document(folder = "Beck 1995")
extract_text(folder = "Beck 1995")
identify_study(study.title = "What to Do (and Not to Do) with Time-Series Cross-Section Data",
                 folder = "Beck 1995"#
                 )
delete_reference_section(folder = "Beck 1995")
delete_running_heads(folder = "Beck 1995")
clean_text(folder = "Beck 1995")
extract_citation_cases(folder = "Beck 1995",
                         authorname = "Beck, Katz",
                         studyyear = "1995"
                         ) # scope = 2
```


## Example: Several studies
* Info on studies should be saved in a  table
* Then we can loop over the table content

```{r, echo=T, eval=F}

publicationdata <- read.table("publicationdata.txt", sep=";",
                                header = T, stringsAsFactors = F)

  for (i in 1:nrow(publicationdata)){

    folder <- publicationdata[i,1]
    study.title <- publicationdata[i,2]
    authorname <- publicationdata[i,3]
    studyyear <- publicationdata[i,4]

    # extract_text(folder = folder)
    # identify_study(study.title = study.title, folder = folder)
    # delete_reference_section(folder = folder)
    # clean_text(folder = folder)
    extract_citation_cases(folder = folder, authorname = authorname, studyyear = studyyear)

  }
```
